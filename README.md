# HarnishBalanceSheet
The HarnishBalanceSheet is an ASP.NET MVP web application that displays a household balance sheet, including assets, liablities, and net worth. It also groups assets by category (Cash, Precious Metals, Real Estate, Bonds, Stocks) and displays targets for asset allocation and the amount by which current asset allocation deviates from targets. Two line graphs are shown, one for Liabilities, one for net worth.
The Snapshot class contains data for one snapshot, or picture of a household's assets and liablitites on a given date. Clicking the date picker and selecting a previous date will give the most recent snapshot as of that date.
The HarnishBalanceSheet uses the repository pattern to loosely couple the data access methodology to the web application. The class used for the Repository is input in the configuration file. The given code reads json files from Azure storage and serializes the files to Snapshot classes. The targets.json is a required file which lists the five asset categories and asset allocation as a fraction. Business rules are then applied to sum the assets and liabilities and calculate a Net Worth.
You can create a new snapshot by clicking the Edit link. Then you can add new values for the Assets and Liabilities in the given text boxes. By clicking Edit next to an Asset, you can change the fractions of that asset assigned to the different asset categories. Only assets that don't have a Type assigned to them have the Edit link. The rationale is, for example for a Checking account, the asset type is always Cash - you wouldn't allocate portions of a Checking account to Real Estate or Precious Metals. You can also add Assets or Liabilities in Edit mode. Additions are done using jQuery. You can edit Coins by changing the number of ounces in each Precious Metal (Gold, Silver, Platinum, Palladium, or Rhodium). After you click Save the back-end logic will get the current price per ounce of Gold, Silver, Platinum, and Palladium (but not Rhodium, which must be entered manually). There are web APIs that provide the current price of Gold, Silver, Platinum, and Palladium for free but I have not found one for Rhodium free. Clicking Save will save a new snapshot to the Repository with the current date.
Under the Balance Sheet the web application displays assets grouped by Category. Below this the application displays the number of Coins owned grouped according to Metal type, with the number of ounces and price per ounce on that date. To the right of this the application displays target allocations by Category, the current amount allocated to that category, and the difference. The asset group that is the furthest from target is highlighted in red.
The UpdateStockPrice project is meant to run as a Web Job in Azure. It is designed to run once a day. It interoperates with a SQL database. For every open position listed in the database, it retrieves the current stock price from Yahoo finance and updates the database accordingly.
